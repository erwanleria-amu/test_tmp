<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="robots" content="noindex,nofollow" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Symfony Profiler</title>
        <link rel="icon" type="image/x-icon" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAFEUlEQVR4AZVXA4wm2RMf27bXDM/+3/+sYBGfrbVtezc6BWtzfPbYXtvDL9906t6v0vWl05me7q1JzXuvvu4yXnvZgJ9hH6bwZYXLFR739vauUGuDwhq1L1N4Uv/tRYUhFjwcg49hn6aYr1V4TiGp86CoP9Oh1tV414KnM6t9fHymKUZ3DAI0hW4b1AyK3lE8phh5OxWeoJgUGhi5mLm95YzBwcHuhIQEV1JSEoWGhoKWHxYWFmenhJ/B5W0GwZpDt5Ovry9lZWWRyWOu5ORk7JsUpogsq5gnmISTU+HKQoLFQv/qq6/os88+I+EVFRUlSsRZ5oRiVmwlXMWShQkahUdERJCfnx/vd+3aRTU1NXTixAmqrq6mK1eu0PTp05mnrmD+QK6XhLO0XP2O2FJAQICRjjMU4P1PP/1EfX19NGfOHM8Z0N7ezueQkBBXYGAgSWIaQ5Em2T5QzFNSUig9PV3OHOe4uDjZ87p//34C7Nm7x/NcRUUFAX799Vec8Y7m7+8Pz92SfBDXr7VwPYRbxn/MmDG8Tps2jQBd3V30/PPPe35/6qmnaPXq1TR69Gg+h4eHiwwosdLT4dBkQDSXWmJiIq/vv/8+/fvvv3ThwgWqr6+n/Px8oyCmAerq6jy03Nxc2Yv7ySSjQzrmi4i92fVpaWlYOZ79/f2MW7dtpSlTptDp06epo6ODPvroI850ASiGdyZOnEjXrl2jyspKT4XA9cgjkaPL/D8UWG62HokieyQQoKSkRGiMs2bNotraWmprayOBNWvWyO+scGdnp5zF/WYvLEb8TwpRykp1MV7feust6uzqJMD169fpueeeY/rDDz/MKzzgdrsJoGkaffvtt/TFF19wQsIDmzZtssojt+6Fo1CgzKiAvAB3DRs2jAULtLS0eErPGB5Ad3c3lZaWUnFxMfeAd955h5+JjY3FaqXAPwhBnRCNySK4b98+Aoilv/z6i/zGggSk1g0opWupAMvGP91yt96zadWqVdTc3Ezz58/31LOAy+US6zgHBP766y+mDR8+HBUgFWSnQI2EAFnqlpcaGxsJIFkMN8L9AnPnzmX6jRs3SACeAi0vL888JwYPgTEJpauhnADo6/LSgQMHCHD37l2Cp15//XXq7eslgKb+Fi1exM9lZmbaCDclIcpQQhATE4OVsrOzuamg+cyePZuzG64Hrlu3jp9ZuWolCdy+fZueeOIJpkdHR1sLHqgM0Yh0bTRz1m7fvp2KiopYkYKCApo8ebLZIwzlFeXSOXEnsLPe2Ij+p5DbYYdOdOtDQ0rNjFya5sTcsGGDcTDZoXTcNoVBMoxWyzDS2yXmOyeUtGSskmDjx4/nRgPAfBDmMpZtUIbRcsi2GsfSD2QYyd2OcdmyZSSwdu1apuXk5GB16v4bak0yX0imyIUEgwNovFTglhMZGcm0srIy43zAVUxuTLbW4xn17Fci23wly9dngUummrTaixcvMpOtW7fiiBwQpqKYU9efHuxDJE5hC9wvL9TW1RLg+PHjPGTQ8wsLC4WpDC5Y5UR4k5qKMSLT6lqeAiX0nuAaMmSI9sMPP9CZM2foyJEj9O677wpTVIuTjidNp0HibvttoH9E5OMqbWKkSaNSlojldoLF7TEP+nUEmKI62y1kOBINbVaNarcI0PuGGUlHyfYvLHg7/jhFSFYqZh0P8KHSptd5ksOPU3tvqAEUot/hFmOIYJLp87wGe9Dwm95eg5xa/R8G6d8U5EcFhwAAAABJRU5ErkJggg==">

            <style>
        
html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{margin:.67em 0;font-size:2em}mark{color:#000;background:#ff0}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{height:0;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;font:inherit;color:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{padding:.35em .625em .75em;margin:0 2px;border:1px solid silver}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}

html, body  {
    height: 100%;
    width: 100%;
}
body {
    background-color: #F9F9F9;
    color: #aaa;
    display: flex;
    flex-direction: column;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 14px;
    line-height: 1.4;
}
.header {
    background-color: #222;
    position: fixed;
    top: 0;
    display: flex;
    width: 100%;
}
.header h1 {
    color: #FFF;
    font-weight: normal;
    font-size: 21px;
    margin: 0;
    padding: 10px 10px 8px;
    word-break: break-all;
}

a.doc {
    color: #FFF;
    text-decoration: none;
    margin: auto;
    margin-right: 10px;
}

a.doc:hover {
    text-decoration: underline;
}

.source {
    margin-top: 41px;
}

.source li code {
    color: #555;
}

.source li.selected {
    background: rgba(255, 255, 153, 0.5);
}

.anchor {
    position: relative;
    display: inline-block;
    top: -7em;
    visibility: hidden;
}

    </style>
    </head>
    <body>
        <div class="header">
    <h1>src/AppBundle/Controller/CommunityController.php <small>line 293</small></h1>
    <a class="doc" href="https://symfony.com/doc/3.4.15/reference/configuration/framework.html#ide" rel="help">Open in your IDE?</a>
</div>
<div class="source">
    <ol start="1"><li><a class="anchor" name="line1"></a><code><span style="color: #0000BB">&lt;?php</span></span></code></li>
<li><a class="anchor" name="line2"></a><code><span style="color: #0000BB"></span></span></code></li>
<li><a class="anchor" name="line3"></a><code><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Controller</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line4"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line5"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line6"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Entity</span><span style="color: #007700">\</span><span style="color: #0000BB">Favorite</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line7"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Entity</span><span style="color: #007700">\</span><span style="color: #0000BB">Itinerary</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line8"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Entity</span><span style="color: #007700">\</span><span style="color: #0000BB">ItineraryStep</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line9"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Entity</span><span style="color: #007700">\</span><span style="color: #0000BB">Location</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line10"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Entity</span><span style="color: #007700">\</span><span style="color: #0000BB">Waypoint</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line11"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">AppBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Form</span><span style="color: #007700">\</span><span style="color: #0000BB">ProfileEditForm</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line12"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">DateTime</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line13"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">Sensio</span><span style="color: #007700">\</span><span style="color: #0000BB">Bundle</span><span style="color: #007700">\</span><span style="color: #0000BB">FrameworkExtraBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Configuration</span><span style="color: #007700">\</span><span style="color: #0000BB">Route</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line14"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">Symfony</span><span style="color: #007700">\</span><span style="color: #0000BB">Bundle</span><span style="color: #007700">\</span><span style="color: #0000BB">FrameworkBundle</span><span style="color: #007700">\</span><span style="color: #0000BB">Controller</span><span style="color: #007700">\</span><span style="color: #0000BB">Controller</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line15"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">Symfony</span><span style="color: #007700">\</span><span style="color: #0000BB">Component</span><span style="color: #007700">\</span><span style="color: #0000BB">HttpFoundation</span><span style="color: #007700">\</span><span style="color: #0000BB">RedirectResponse</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line16"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">Symfony</span><span style="color: #007700">\</span><span style="color: #0000BB">Component</span><span style="color: #007700">\</span><span style="color: #0000BB">HttpFoundation</span><span style="color: #007700">\</span><span style="color: #0000BB">Request</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line17"></a><code><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">Symfony</span><span style="color: #007700">\</span><span style="color: #0000BB">Component</span><span style="color: #007700">\</span><span style="color: #0000BB">HttpFoundation</span><span style="color: #007700">\</span><span style="color: #0000BB">Response</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line18"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line19"></a><code><span style="color: #007700"></span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line20"></a><code><span style="color: #FF8000">&nbsp;*</span></span></code></li>
<li><a class="anchor" name="line21"></a><code><span style="color: #FF8000">&nbsp;*&nbsp;Ensemble&nbsp;des&nbsp;pages&nbsp;liées&nbsp;à&nbsp;la&nbsp;communauté.</span></span></code></li>
<li><a class="anchor" name="line22"></a><code><span style="color: #FF8000">&nbsp;*</span></span></code></li>
<li><a class="anchor" name="line23"></a><code><span style="color: #FF8000">&nbsp;*&nbsp;Class&nbsp;CommunityController</span></span></code></li>
<li><a class="anchor" name="line24"></a><code><span style="color: #FF8000">&nbsp;*&nbsp;@package&nbsp;AppBundle\Controller</span></span></code></li>
<li><a class="anchor" name="line25"></a><code><span style="color: #FF8000">&nbsp;*&nbsp;@Route("/community")</span></span></code></li>
<li><a class="anchor" name="line26"></a><code><span style="color: #FF8000">&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line27"></a><code><span style="color: #FF8000"></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">CommunityController&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Controller</span></span></code></li>
<li><a class="anchor" name="line28"></a><code><span style="color: #0000BB"></span><span style="color: #007700">{</span></span></code></li>
<li><a class="anchor" name="line29"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line30"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Affichage&nbsp;du&nbsp;profil&nbsp;de&nbsp;l'utilisateur</span></span></code></li>
<li><a class="anchor" name="line31"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></code></li>
<li><a class="anchor" name="line32"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/profile/{username}",&nbsp;name="profile-index")</span></span></code></li>
<li><a class="anchor" name="line33"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line34"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$username</span></span></code></li>
<li><a class="anchor" name="line35"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line36"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line37"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">profileAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line38"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line39"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Récupération&nbsp;de&nbsp;l'utilisateur&nbsp;(si&nbsp;il&nbsp;existe)&nbsp;depuis&nbsp;la&nbsp;base&nbsp;de&nbsp;données&nbsp;via&nbsp;son&nbsp;username</span></span></code></li>
<li><a class="anchor" name="line40"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line41"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:User'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line42"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'username'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">));</span></span></code></li>
<li><a class="anchor" name="line43"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line44"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;n'est&nbsp;pas&nbsp;trouvé,&nbsp;on&nbsp;renvoie&nbsp;une&nbsp;erreur&nbsp;404</span></span></code></li>
<li><a class="anchor" name="line45"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createNotFoundException</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line46"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line47"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Sinon&nbsp;on&nbsp;renvoie&nbsp;la&nbsp;vue&nbsp;de&nbsp;profil&nbsp;avec&nbsp;l'objet&nbsp;User.</span></span></code></li>
<li><a class="anchor" name="line48"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'community/profile.html.twig'</span><span style="color: #007700">,&nbsp;[</span></span></code></li>
<li><a class="anchor" name="line49"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'user'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,</span></span></code></li>
<li><a class="anchor" name="line50"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);</span></span></code></li>
<li><a class="anchor" name="line51"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line52"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line53"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line54"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line55"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></code></li>
<li><a class="anchor" name="line56"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Edition&nbsp;du&nbsp;profil&nbsp;de&nbsp;l'utilisateur</span></span></code></li>
<li><a class="anchor" name="line57"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span></span></code></li>
<li><a class="anchor" name="line58"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/profile/{username}/edit",&nbsp;name="profile-edit")</span></span></code></li>
<li><a class="anchor" name="line59"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line60"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$username</span></span></code></li>
<li><a class="anchor" name="line61"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;RedirectResponse|Response</span></span></code></li>
<li><a class="anchor" name="line62"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line63"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">profileEdit</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line64"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line65"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Récupération&nbsp;de&nbsp;l'utilisateur&nbsp;(si&nbsp;il&nbsp;existe)&nbsp;depuis&nbsp;la&nbsp;base&nbsp;de&nbsp;données&nbsp;via&nbsp;son&nbsp;username</span></span></code></li>
<li><a class="anchor" name="line66"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line67"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:User'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line68"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'username'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">));</span></span></code></li>
<li><a class="anchor" name="line69"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line70"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;n'est&nbsp;pas&nbsp;trouvé,&nbsp;on&nbsp;renvoie&nbsp;une&nbsp;erreur&nbsp;404</span></span></code></li>
<li><a class="anchor" name="line71"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createNotFoundException</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line72"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;connecté&nbsp;n'est&nbsp;pas&nbsp;le&nbsp;propriétaire&nbsp;du&nbsp;profil,&nbsp;on&nbsp;renvoie&nbsp;une&nbsp;erreur&nbsp;401&nbsp;Forbidden</span></span></code></li>
<li><a class="anchor" name="line73"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">())&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createAccessDeniedException</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line74"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line75"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line76"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line77"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;prépare&nbsp;le&nbsp;formulaire</span></span></code></li>
<li><a class="anchor" name="line78"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$form&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createForm</span><span style="color: #007700">(</span><span style="color: #0000BB">ProfileEditForm</span><span style="color: #007700">::class);</span></span></code></li>
<li><a class="anchor" name="line79"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'description'</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">setData</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDescription</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line80"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">handleRequest</span><span style="color: #007700">(</span><span style="color: #0000BB">$request</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line81"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line82"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isSubmitted</span><span style="color: #007700">()&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">())&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line83"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'avatar'</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">getData</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line84"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line85"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;a&nbsp;modifié&nbsp;son&nbsp;avatar</span></span></code></li>
<li><a class="anchor" name="line86"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line87"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$fileName&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">uniqid</span><span style="color: #007700">())&nbsp;.&nbsp;</span><span style="color: #DD0000">'.'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$file</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">guessExtension</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line88"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$file</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">move</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">'avatars_dir'</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">$fileName</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line89"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line90"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;à&nbsp;un&nbsp;avatar&nbsp;autre&nbsp;que&nbsp;celui&nbsp;par&nbsp;défaut,&nbsp;on&nbsp;le&nbsp;supprime</span></span></code></li>
<li><a class="anchor" name="line91"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getAvatar</span><span style="color: #007700">()&nbsp;!==&nbsp;</span><span style="color: #DD0000">'default.png'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line92"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getParameter</span><span style="color: #007700">(</span><span style="color: #DD0000">'avatars_dir'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">'/'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getAvatar</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line93"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line94"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setAvatar</span><span style="color: #007700">(</span><span style="color: #0000BB">$fileName</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line95"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line96"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line97"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setDescription</span><span style="color: #007700">(</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'description'</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">getData</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line98"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line99"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line100"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">redirectToRoute</span><span style="color: #007700">(</span><span style="color: #DD0000">'profile-index'</span><span style="color: #007700">,&nbsp;[</span></span></code></li>
<li><a class="anchor" name="line101"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'username'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$username</span></span></code></li>
<li><a class="anchor" name="line102"></a><code><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line103"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line104"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'community/profile-edit.html.twig'</span><span style="color: #007700">,&nbsp;[</span></span></code></li>
<li><a class="anchor" name="line105"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'user'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,</span></span></code></li>
<li><a class="anchor" name="line106"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'form'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createView</span><span style="color: #007700">(),</span></span></code></li>
<li><a class="anchor" name="line107"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);</span></span></code></li>
<li><a class="anchor" name="line108"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line109"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line110"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line111"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/add-friend",&nbsp;name="add-Friend",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line112"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line113"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;permettant&nbsp;d'envoyer&nbsp;une&nbsp;requête&nbsp;d'ami</span></span></code></li>
<li><a class="anchor" name="line114"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line115"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line116"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">addFriendAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line117"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line118"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line119"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line120"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line121"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:User'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line122"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">([</span><span style="color: #DD0000">'id'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'userId'</span><span style="color: #007700">]]);</span></span></code></li>
<li><a class="anchor" name="line123"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line124"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;n'est&nbsp;pas&nbsp;trouvé,&nbsp;on&nbsp;renvoie&nbsp;l'échec&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line125"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line126"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line127"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Sinon&nbsp;on&nbsp;l'ajoute&nbsp;en&nbsp;attente&nbsp;d'acceptation&nbsp;dans&nbsp;la&nbsp;liste&nbsp;d'amis&nbsp;de&nbsp;l'autre&nbsp;utilisateur</span></span></code></li>
<li><a class="anchor" name="line128"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addPendingFriendRequest</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line129"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line130"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line131"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line132"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line133"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line134"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line135"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line136"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/remove-friend",&nbsp;name="remove-Friend",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line137"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line138"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;permettant&nbsp;de&nbsp;retirer&nbsp;un&nbsp;ami</span></span></code></li>
<li><a class="anchor" name="line139"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line140"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line141"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">removeFriendAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line142"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line143"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line144"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line145"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line146"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:User'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line147"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">([</span><span style="color: #DD0000">'id'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'userId'</span><span style="color: #007700">]]);</span></span></code></li>
<li><a class="anchor" name="line148"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line149"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;n'est&nbsp;pas&nbsp;trouvé,&nbsp;on&nbsp;renvoie&nbsp;l'échec&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line150"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line151"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line152"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Sinon&nbsp;on&nbsp;le&nbsp;supprime&nbsp;de&nbsp;la&nbsp;liste&nbsp;d'amis&nbsp;de&nbsp;l'utilisateur</span></span></code></li>
<li><a class="anchor" name="line153"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">removeFriendBothWays</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line154"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line155"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line156"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line157"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line158"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line159"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line160"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line161"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/accept-request",&nbsp;name="accept-request",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line162"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line163"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;permettant&nbsp;d'accepter&nbsp;une&nbsp;requête&nbsp;d'ami</span></span></code></li>
<li><a class="anchor" name="line164"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line165"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line166"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">acceptFriendRequestAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line167"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line168"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line169"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line170"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line171"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:User'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line172"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">([</span><span style="color: #DD0000">'id'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'userId'</span><span style="color: #007700">]]);</span></span></code></li>
<li><a class="anchor" name="line173"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line174"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;n'est&nbsp;pas&nbsp;trouvé,&nbsp;on&nbsp;renvoie&nbsp;l'échec&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line175"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line176"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line177"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Utilisateur&nbsp;courant&nbsp;authentifié</span></span></code></li>
<li><a class="anchor" name="line178"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$currentUser&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line179"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line180"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;ajoute&nbsp;l'utilisateur&nbsp;à&nbsp;la&nbsp;liste&nbsp;d'amis&nbsp;et&nbsp;on&nbsp;le&nbsp;retire&nbsp;de&nbsp;la&nbsp;liste&nbsp;d'attente</span></span></code></li>
<li><a class="anchor" name="line181"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$currentUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addFriendBothWays</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line182"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$currentUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">removePendingFriendRequest</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line183"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line184"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line185"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line186"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line187"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line188"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line189"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line190"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/remove-request",&nbsp;name="remove-request",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line191"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line192"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;permettant&nbsp;de&nbsp;refuser&nbsp;une&nbsp;requête&nbsp;d'ami</span></span></code></li>
<li><a class="anchor" name="line193"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line194"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line195"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">removeFriendRequestAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line196"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line197"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line198"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line199"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line200"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:User'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line201"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">([</span><span style="color: #DD0000">'id'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'userId'</span><span style="color: #007700">]]);</span></span></code></li>
<li><a class="anchor" name="line202"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line203"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;l'utilisateur&nbsp;n'est&nbsp;pas&nbsp;trouvé,&nbsp;on&nbsp;renvoie&nbsp;l'échec&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line204"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line205"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line206"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$currentUser&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line207"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$currentUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">removePendingFriendRequest</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line208"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line209"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line210"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line211"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line212"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line213"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line214"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line215"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/add-favorite",&nbsp;name="add-favorite",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line216"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line217"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;d'ajouter&nbsp;un&nbsp;lieu&nbsp;à&nbsp;ses&nbsp;favoris</span></span></code></li>
<li><a class="anchor" name="line218"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line219"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line220"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">addFavoriteAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line221"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line222"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line223"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line224"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;vérifie&nbsp;si&nbsp;cet&nbsp;endroit&nbsp;est&nbsp;déjà&nbsp;enregistré&nbsp;en&nbsp;base&nbsp;de&nbsp;données</span></span></code></li>
<li><a class="anchor" name="line225"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$locationCheck&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line226"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Location'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line227"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">([</span><span style="color: #DD0000">'latitude'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'lat'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'longitude'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'lng'</span><span style="color: #007700">]]);</span></span></code></li>
<li><a class="anchor" name="line228"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line229"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line230"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Favorite</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line231"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line232"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;le&nbsp;lieu&nbsp;n'existe&nbsp;pas,&nbsp;on&nbsp;l'ajoute</span></span></code></li>
<li><a class="anchor" name="line233"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$locationCheck&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line234"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$location&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Location</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line235"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$location</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setName</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line236"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$location</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLatitude</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'lat'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line237"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$location</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLongitude</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'lng'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line238"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line239"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">persist</span><span style="color: #007700">(</span><span style="color: #0000BB">$location</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line240"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLocation</span><span style="color: #007700">(</span><span style="color: #0000BB">$location</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line241"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line242"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Sinon&nbsp;on&nbsp;définit&nbsp;le&nbsp;lieu&nbsp;comme&nbsp;favori&nbsp;directement</span></span></code></li>
<li><a class="anchor" name="line243"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLocation</span><span style="color: #007700">(</span><span style="color: #0000BB">$locationCheck</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line244"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line245"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setMapId</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'map_id'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line246"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setUser</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line247"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line248"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">persist</span><span style="color: #007700">(</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line249"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line250"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line251"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;tout&nbsp;se&nbsp;passe&nbsp;correctement,&nbsp;on&nbsp;renvoie&nbsp;l'id&nbsp;du&nbsp;nouveau&nbsp;favori&nbsp;créé</span></span></code></li>
<li><a class="anchor" name="line252"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getId</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line253"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line254"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line255"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line256"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/remove-favorite",&nbsp;name="remove-favorite",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line257"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line258"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;de&nbsp;supprimer&nbsp;un&nbsp;lieu&nbsp;de&nbsp;ses&nbsp;favoris</span></span></code></li>
<li><a class="anchor" name="line259"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line260"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line261"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">removeFavoriteAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line262"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line263"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line264"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line265"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line266"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line267"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Favorite'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line268"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line269"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line270"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;le&nbsp;favori&nbsp;n'est&nbsp;pas&nbsp;trouvé</span></span></code></li>
<li><a class="anchor" name="line271"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$favorite&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line272"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line273"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line274"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">remove</span><span style="color: #007700">(</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line275"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line276"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line277"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line278"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line279"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line280"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line281"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/get-location",&nbsp;name="get-location",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line282"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line283"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;lors&nbsp;de&nbsp;l'affichage&nbsp;de&nbsp;la&nbsp;carte,&nbsp;d'afficher&nbsp;les&nbsp;lieus&nbsp;que&nbsp;l'utilisateur&nbsp;à&nbsp;déjà&nbsp;ajouté&nbsp;en&nbsp;favoris</span></span></code></li>
<li><a class="anchor" name="line284"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line285"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line286"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getLocationAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line287"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line288"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line289"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line290"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line291"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$favorite&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line292"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Favorite'</span><span style="color: #007700">)</span></span></code></li>
<li class="selected"><a class="anchor" name="line293"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">findOneBy</span><span style="color: #007700">([</span><span style="color: #DD0000">'map_id'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'map_id'</span><span style="color: #007700">]]);</span></span></code></li>
<li><a class="anchor" name="line294"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line295"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$favorite&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line296"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #0000BB">$favorite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getId</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line297"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line298"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line299"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line300"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line301"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/join-event",&nbsp;name="join-event",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line302"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line303"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;à&nbsp;un&nbsp;utilisateur&nbsp;de&nbsp;rejoindre&nbsp;un&nbsp;évènement</span></span></code></li>
<li><a class="anchor" name="line304"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line305"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line306"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">joinEventAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line307"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line308"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line309"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line310"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line311"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line312"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Event'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line313"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'eventId'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line314"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line315"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$event&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line316"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line317"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$event</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addParticipant</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line318"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line319"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line320"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getAvatar</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line321"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line322"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line323"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line324"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/quit-event",&nbsp;name="quit-event",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line325"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line326"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;à&nbsp;un&nbsp;utilisateur&nbsp;de&nbsp;quitter&nbsp;un&nbsp;évènement</span></span></code></li>
<li><a class="anchor" name="line327"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line328"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line329"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">quitEventAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line330"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line331"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line332"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line333"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line334"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line335"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Event'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line336"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'eventId'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line337"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line338"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$event&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line339"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line340"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$event</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">removeParticipant</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line341"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line342"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line343"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line344"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getUsername</span><span style="color: #007700">());</span></span></code></li>
<li><a class="anchor" name="line345"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line346"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line347"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line348"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/update-cities",&nbsp;name="update-stats-cities",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line349"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line350"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;de&nbsp;comptabiliser&nbsp;le&nbsp;nombre&nbsp;de&nbsp;villes&nbsp;cherchées&nbsp;par&nbsp;les&nbsp;utilisateurs&nbsp;(purement&nbsp;statistiques)</span></span></code></li>
<li><a class="anchor" name="line351"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line352"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line353"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">updateCitiesAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line354"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line355"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line356"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line357"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line358"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line359"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAILED'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line360"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line361"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setCities</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCities</span><span style="color: #007700">()&nbsp;+&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'cities'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line362"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line363"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line364"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line365"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line366"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line367"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line368"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/add-route",&nbsp;name="add-route",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line369"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line370"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">addRouteAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line371"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line372"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line373"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUser</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line374"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line375"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAILED'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line376"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line377"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Itinerary</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line378"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line379"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">))&nbsp;</span><span style="color: #0000BB">$itineraryName&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"Itinéraire&nbsp;sans&nbsp;nom"</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line380"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">$itineraryName&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">];</span></span></code></li>
<li><a class="anchor" name="line381"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line382"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'duration'</span><span style="color: #007700">]&nbsp;&gt;=&nbsp;</span><span style="color: #0000BB">86400</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">$itineraryDuration&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;</span></span></code></li>
<li><a class="anchor" name="line383"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</span><span style="color: #0000BB">$itineraryDuration&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DateTime</span><span style="color: #007700">(</span><span style="color: #0000BB">gmdate</span><span style="color: #007700">(</span><span style="color: #DD0000">"H:i:s"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'duration'</span><span style="color: #007700">]));</span></span></code></li>
<li><a class="anchor" name="line384"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line385"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line386"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line387"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setName</span><span style="color: #007700">(</span><span style="color: #0000BB">$itineraryName</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line388"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setAuthor</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line389"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setDistance</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'distance'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line390"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setDuration</span><span style="color: #007700">(</span><span style="color: #0000BB">$itineraryDuration</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line391"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setPolyline</span><span style="color: #007700">(</span><span style="color: #0000BB">addslashes</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'polyline'</span><span style="color: #007700">]));</span></span></code></li>
<li><a class="anchor" name="line392"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">persist</span><span style="color: #007700">(</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line393"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line394"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'waypoints'</span><span style="color: #007700">]&nbsp;as&nbsp;</span><span style="color: #0000BB">$coordinates</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line395"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line396"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$waypoint&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Waypoint</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line397"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$waypoint</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLatitude</span><span style="color: #007700">(</span><span style="color: #0000BB">$coordinates</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line398"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$waypoint</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLongitude</span><span style="color: #007700">(</span><span style="color: #0000BB">$coordinates</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line399"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$waypoint</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setItinerary</span><span style="color: #007700">(</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line400"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">persist</span><span style="color: #007700">(</span><span style="color: #0000BB">$waypoint</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line401"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line402"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line403"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line404"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line405"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line406"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line407"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/itinerary/{itineraryId}",&nbsp;name="view-itinerary")</span></span></code></li>
<li><a class="anchor" name="line408"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line409"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$itineraryId</span></span></code></li>
<li><a class="anchor" name="line410"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string|\Symfony\Component\HttpKernel\Exception\NotFoundHttpException</span></span></code></li>
<li><a class="anchor" name="line411"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line412"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">viewItineraryAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$itineraryId</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line413"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line414"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line415"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Itinerary'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line416"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">(</span><span style="color: #0000BB">$itineraryId</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line417"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line418"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$itinerary&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createNotFoundException</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line419"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line420"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'default/itinerary-view.html.twig'</span><span style="color: #007700">,&nbsp;[</span></span></code></li>
<li><a class="anchor" name="line421"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'itinerary'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$itinerary</span></span></code></li>
<li><a class="anchor" name="line422"></a><code><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line423"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line424"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line425"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/**</span></span></code></li>
<li><a class="anchor" name="line426"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@Route("/remove-itinerary",&nbsp;name="remove-itinerary",&nbsp;options={"expose"&nbsp;=&nbsp;true})</span></span></code></li>
<li><a class="anchor" name="line427"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;Request&nbsp;$request</span></span></code></li>
<li><a class="anchor" name="line428"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Action&nbsp;AJAX&nbsp;qui&nbsp;permet&nbsp;de&nbsp;supprimer&nbsp;un&nbsp;itinéraire</span></span></code></li>
<li><a class="anchor" name="line429"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Response</span></span></code></li>
<li><a class="anchor" name="line430"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></span></code></li>
<li><a class="anchor" name="line431"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">removeItineraryAction</span><span style="color: #007700">(</span><span style="color: #0000BB">Request&nbsp;$request</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line432"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;{</span></span></code></li>
<li><a class="anchor" name="line433"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;On&nbsp;récupère&nbsp;les&nbsp;données&nbsp;de&nbsp;la&nbsp;requête</span></span></code></li>
<li><a class="anchor" name="line434"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line435"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line436"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$itinerary&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()</span></span></code></li>
<li><a class="anchor" name="line437"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">getRepository</span><span style="color: #007700">(</span><span style="color: #DD0000">'AppBundle:Itinerary'</span><span style="color: #007700">)</span></span></code></li>
<li><a class="anchor" name="line438"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">]);</span></span></code></li>
<li><a class="anchor" name="line439"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line440"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Si&nbsp;le&nbsp;favori&nbsp;n'est&nbsp;pas&nbsp;trouvé</span></span></code></li>
<li><a class="anchor" name="line441"></a><code><span style="color: #FF8000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$itinerary&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'FAIL'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line442"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line443"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDoctrine</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getManager</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line444"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">remove</span><span style="color: #007700">(</span><span style="color: #0000BB">$itinerary</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line445"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$em</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">flush</span><span style="color: #007700">();</span></span></code></li>
<li><a class="anchor" name="line446"></a><code><span style="color: #007700"></span></span></code></li>
<li><a class="anchor" name="line447"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;</span><span style="color: #0000BB">Response</span><span style="color: #007700">(</span><span style="color: #DD0000">'DONE'</span><span style="color: #007700">);</span></span></code></li>
<li><a class="anchor" name="line448"></a><code><span style="color: #007700">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></code></li>
<li><a class="anchor" name="line449"></a><code><span style="color: #007700">}</span>
</span></code></li></ol>
</div>
    </body>
</html>
